window.__require=function e(t,o,i){function r(a,c){if(!o[a]){if(!t[a]){var s=a.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(n)return n(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var d=o[a]={exports:{}};t[a][0].call(d.exports,function(e){return r(t[a][1][e]||e)},d,d.exports,e,t,o,i)}return o[a].exports}for(var n="function"==typeof __require&&__require,a=0;a<i.length;a++)r(i[a]);return r}({Audio:[function(e,t,o){"use strict";cc._RF.push(t,"ce23d+RaSVFz6nUXtrbDGjn","Audio"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,n=i.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.up1024=null,t.down1024=null,t.noCombine=null,t.gameOver=null,t.relive=null,t}return __extends(t,e),t.prototype.onLoad=function(){this._switch=!0},t.prototype.start=function(){},t.prototype.play=function(e,t){this._switch&&cc.audioEngine.play(e,t,.75)},__decorate([n({type:cc.AudioClip})],t.prototype,"up1024",void 0),__decorate([n({type:cc.AudioClip})],t.prototype,"down1024",void 0),__decorate([n({type:cc.AudioClip})],t.prototype,"noCombine",void 0),__decorate([n({type:cc.AudioClip})],t.prototype,"gameOver",void 0),__decorate([n({type:cc.AudioClip})],t.prototype,"relive",void 0),t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],ExitGame:[function(e,t,o){"use strict";cc._RF.push(t,"7a92a3RCJJIA6uIG1PqFq61","ExitGame"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Helper"),r=cc._decorator,n=r.ccclass,a=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.init=function(e){this._game=e},t.prototype.onBackHome=function(){this.node.active=!0},t.prototype.onSureExit=function(){cc.log("exit"),i.Helper.ins.sendEvent(i.HelperEvent.gameExited)},t.prototype.onCancelExit=function(){this.node.active=!1},t=__decorate([n],t)}(cc.Component));o.default=a,cc._RF.pop()},{"./Helper":"Helper"}],GameOver:[function(e,t,o){"use strict";cc._RF.push(t,"4ffe39qX+pBDJ0/fdGBl3C1","GameOver"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Helper"),r=cc._decorator,n=r.ccclass,a=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.btnRelive=null,t.btnSkip=null,t.btnGetGold=null,t.btnGet10Gold=null,t.btnPlayAgain=null,t.roleIcon=null,t.lbScore=null,t.lbName=null,t.lb10Gold=null,t.lbGold=null,t.jinbiSound=null,t.jinbiEffect=null,t}return __extends(t,e),t.prototype.onLoad=function(){cc.game.on("adCompleted",this.onAdOver,this)},t.prototype.onAdOver=function(){console.log("onAdOver----"),this._game._life<0?(this._game.RoleHead.doubleCoin(),this.sendGetCoin(10)):(this.node.destroy(),this._game.startTimer())},t.prototype.showResult=function(e,t){this._game=e;var o=0==this._game._score;this.btnRelive.active=t,this.btnSkip.active=t,this.btnGetGold.active=!t&&!o,this.btnGet10Gold.active=!t&&!o,this.btnPlayAgain.active=o&&!t,this.lbScore.string=e._score+"";var r=i.Helper.ins.roleInfo,n=e.RoleHead._curCoin;if(this.lbGold.string=n+"",this.lb10Gold.string=10*n+"",r){console.log("nickname"),this.lbName.string=r.nickname;var a=r.headImgUrl+"?aaa=aa.jpg";cc.log("imgUrl:"+a);var c=this;cc.loader.load(a,function(e,t){e||(c.roleIcon.spriteFrame=new cc.SpriteFrame(t))})}},t.prototype.onReliveClick=function(){cc.log("onReliveClick"),i.Helper.ins.sendEvent(i.HelperEvent.adPlay)},t.prototype.onSkip=function(){cc.log("onSkip"),this.node.destroy(),this._game.gameOver()},t.prototype.onGetGold=function(){cc.log("onGetGold"),this.showGetGold(),this.sendGetCoin(1)},t.prototype.showGetGold=function(){cc.audioEngine.play(this.jinbiSound,!1,1),this.jinbiEffect.resetSystem(),this.scheduleOnce(this.onPlayAgain,this.jinbiEffect.life)},t.prototype.onPlayAgain=function(){cc.director.loadScene("Game")},t.prototype.sendGetCoin=function(e){var t=this._game._score,o=this._game.RoleHead._curCoin;i.Helper.ins.sendRoundEvent(i.HelperEvent.roundOver,{score:t,rewardCoin:o,multiple:e})},t.prototype.onGet10Gold=function(){cc.log("onGet10Gold"),i.Helper.ins.sendEvent(i.HelperEvent.adPlay)},t.prototype.onShareClick=function(){this._game.openShare()},__decorate([a(cc.Node)],t.prototype,"btnRelive",void 0),__decorate([a(cc.Node)],t.prototype,"btnSkip",void 0),__decorate([a(cc.Node)],t.prototype,"btnGetGold",void 0),__decorate([a(cc.Node)],t.prototype,"btnGet10Gold",void 0),__decorate([a(cc.Node)],t.prototype,"btnPlayAgain",void 0),__decorate([a(cc.Sprite)],t.prototype,"roleIcon",void 0),__decorate([a(cc.Label)],t.prototype,"lbScore",void 0),__decorate([a(cc.Label)],t.prototype,"lbName",void 0),__decorate([a(cc.Label)],t.prototype,"lb10Gold",void 0),__decorate([a(cc.Label)],t.prototype,"lbGold",void 0),__decorate([a({type:cc.AudioClip})],t.prototype,"jinbiSound",void 0),__decorate([a(cc.ParticleSystem)],t.prototype,"jinbiEffect",void 0),t=__decorate([n],t)}(cc.Component);o.default=c,cc._RF.pop()},{"./Helper":"Helper"}],Game:[function(e,t,o){"use strict";cc._RF.push(t,"07d62EIlZtGgper4sEnGaRb","Game"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Audio"),r=e("./RoleHead"),n=e("./Helper"),a=cc._decorator,c=a.ccclass,s=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.GameLayer=null,t.Number=null,t.Numbers=[],t.LabelScore=null,t.Audio=null,t.RoleHead=null,t.GeZi=null,t.GameOver=null,t.GameTimer=null,t.ShareLayer=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegine,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.unit_width=this.GameLayer.width/4,this.unit_height=this.GameLayer.height/4,this.allNumbers=new Array,this.allNodes=new Array,this.Audio=this.Audio;for(var e=0;e<4;e++){this.allNumbers[e]=new Array;for(var t=0;t<4;t++)this.allNumbers[e][t]=0}this.addRandNum(),this.addRandNum(),this.createGeZi(),this.RoleHead.init(this),this._score=0,this._curMaxScore=0,this.refreshGame(),this._pause=!1},t.prototype.updateScore=function(){this.LabelScore.string=this._score+"";var e=n.Helper.ins.rate;console.log("rate:"+e),this.RoleHead.setCoin(Math.floor(this._score/e))},t.prototype.createGeZi=function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++){var o=cc.instantiate(this.GeZi);o.x=(e+.5)*this.unit_width,o.y=this.GameLayer.height-(t+.5)*this.unit_height,o.parent=this.GameLayer}},t.prototype.createNumber=function(e,t,o){for(var i=0,r=o;i++,1!=(r/=2););i>15&&(i=15);var n=cc.instantiate(this.Numbers[i-1]);15==i&&(n.getChildByName("LabelNum").getComponent(cc.Label).string=o);n.parent=this.GameLayer,n.x=(e+.5)*this.unit_width,n.y=this.GameLayer.height-(t+.5)*this.unit_height,n.nx=n.x,n.ny=n.y,this.allNodes[4*e+t]=n},t.prototype.changeNodePos=function(e,t,o,i){var r=this.allNodes[4*e+t];r&&(r.nx=(o+.5)*this.unit_width,r.ny=this.GameLayer.height-(i+.5)*this.unit_height)},t.prototype.checkGameOver=function(){if(this.getNullCount()>0)return!1;for(var e=0;e<4;e++)for(var t=0;t<3;t++)if(this.allNumbers[e][t]==this.allNumbers[e][t+1]||this.allNumbers[t][e]==this.allNumbers[t+1][e])return!1;return!0},t.prototype.onTouchBegine=function(e){this.startPoint=e.getLocation()},t.prototype.refreshGame=function(){for(var e=0;e<16;e++){var t=this.allNodes[e];t&&t.destroy()}this.allNodes=[],this._need_add_num&&(this.addRandNum(),this._need_add_num=0);for(e=0;e<4;e++)for(var o=0;o<4;o++){var i=this.allNumbers[e][o];0!=i&&this.createNumber(o,e,i)}this.updateScore(),this._curMaxScore>0&&this._curMaxScore<1024?this.Audio.play(this.Audio.down1024,!1):this._curMaxScore>=1024&&this.Audio.play(this.Audio.up1024,!1),0==this._curMaxScore&&this.Audio.play(this.Audio.noCombine,!1),this._curMaxScore=0,this.checkGameOver()&&this.gameOver()},t.prototype.gameOver=function(){this._pause=!0,this.Audio.play(this.Audio.gameOver,!1);var e=cc.instantiate(this.GameOver);e.parent=this.node;var t=e.getComponent("GameOver");t&&(t.showResult(this,this._life>0&&this._score>100),this._life--)},t.prototype.move2Reset=function(){for(var e=0;e<16;e++){var t=this.allNodes[e];t&&t.runAction(cc.moveTo(.05,cc.v2(t.nx,t.ny)))}this.scheduleOnce(this.refreshGame,.05)},t.prototype.moveLeft=function(){for(var e=this.allNumbers,t=0;t<4;++t){var o,i;for(o=1,i=0;o<4;++o)if(e[t][o]>0)if(e[t][i]==e[t][o]){var r=e[t][i]*=2;r>this._curMaxScore&&(this._curMaxScore=r),this._score+=r,e[t][o]=0,this.changeNodePos(o,t,i,t),i++,this._need_add_num=1}else 0==e[t][i]?(e[t][i]=e[t][o],e[t][o]=0,this.changeNodePos(o,t,i,t),this._need_add_num=1):(i++,e[t][i]=e[t][o],this.changeNodePos(o,t,i,t),o!=i&&(e[t][o]=0,this._need_add_num=1))}},t.prototype.moveRight=function(){for(var e=this.allNumbers,t=0;t<4;++t){var o,i;for(o=2,i=3;o>=0;--o)if(e[t][o]>0)if(e[t][i]==e[t][o]){var r=e[t][i]*=2;r>this._curMaxScore&&(this._curMaxScore=r),this._score+=r,e[t][o]=0,this.changeNodePos(o,t,i,t),i--,this._need_add_num=1}else 0==e[t][i]?(e[t][i]=e[t][o],e[t][o]=0,this.changeNodePos(o,t,i,t),this._need_add_num=1):(i--,e[t][i]=e[t][o],this.changeNodePos(o,t,i,t),o!=i&&(e[t][o]=0,this._need_add_num=1))}},t.prototype.moveUp=function(){for(var e=this.allNumbers,t=0;t<4;++t){var o,i;for(o=1,i=0;o<4;++o)if(e[o][t]>0)if(e[i][t]==e[o][t]){var r=e[i][t]*=2;r>this._curMaxScore&&(this._curMaxScore=r),this._score+=r,e[o][t]=0,this.changeNodePos(t,o,t,i),i++,this._need_add_num=1}else 0==e[i][t]?(e[i][t]=e[o][t],e[o][t]=0,this.changeNodePos(t,o,t,i),this._need_add_num=1):(e[++i][t]=e[o][t],this.changeNodePos(t,o,t,i),o!=i&&(e[o][t]=0,this._need_add_num=1))}},t.prototype.moveDown=function(){for(var e=this.allNumbers,t=0;t<4;++t){var o,i;for(o=2,i=3;o>=0;--o)if(e[o][t]>0)if(e[i][t]==e[o][t]){var r=e[i][t]*=2;r>this._curMaxScore&&(this._curMaxScore=r),this._score+=r,e[o][t]=0,this.changeNodePos(t,o,t,i),i--,this._need_add_num=1}else 0==e[i][t]?(e[i][t]=e[o][t],e[o][t]=0,this.changeNodePos(t,o,t,i),this._need_add_num=1):(e[--i][t]=e[o][t],this.changeNodePos(t,o,t,i),o!=i&&(e[o][t]=0,this._need_add_num=1))}},t.prototype.addRandNum=function(){for(var e=Math.floor(Math.random()*this.getNullCount()),t=0;t<4;t++)for(var o=0;o<4;o++)if(0==this.allNumbers[t][o]&&0==e--){this.allNumbers[t][o]=Math.random()<.5?2:4;break}},t.prototype.getNullCount=function(){for(var e=0,t=0;t<4;t++)for(var o=0;o<4;o++)0==this.allNumbers[t][o]&&e++;return e},t.prototype.onTouchEnd=function(e){if(!this._pause){var t=e.getLocation();if(!(this.startPoint.sub(t).mag()<5))Math.abs(this.startPoint.x-t.x)>Math.abs(this.startPoint.y-t.y)?t.x>this.startPoint.x?this.moveRight():this.moveLeft():this.startPoint.y>t.y?this.moveDown():this.moveUp(),this.move2Reset()}},t.prototype.resetGame=function(){for(var e=0,t=0,o=0,i=0;i<4;i++)for(var r=0;r<4;r++){var n=this.allNumbers[i][r];n>e&&(e=n,t=i,o=r)}for(i=0;i<4;i++)for(r=0;r<4;r++)i==t&&r==o||(this.allNumbers[i][r]=0)},t.prototype.continueGame=function(){this._pause=!1,this.resetGame(),this.refreshGame()},t.prototype.startTimer=function(){var e=cc.instantiate(this.GameTimer);e.parent=this.node;var t=e.getComponent("Timer");t&&t.init(this)},t.prototype.openShare=function(){cc.instantiate(this.ShareLayer).parent=this.node},__decorate([s(cc.Node)],t.prototype,"GameLayer",void 0),__decorate([s(cc.Prefab)],t.prototype,"Number",void 0),__decorate([s(cc.Prefab)],t.prototype,"Numbers",void 0),__decorate([s(cc.Label)],t.prototype,"LabelScore",void 0),__decorate([s(i.default)],t.prototype,"Audio",void 0),__decorate([s(r.default)],t.prototype,"RoleHead",void 0),__decorate([s(cc.Prefab)],t.prototype,"GeZi",void 0),__decorate([s(cc.Prefab)],t.prototype,"GameOver",void 0),__decorate([s(cc.Prefab)],t.prototype,"GameTimer",void 0),__decorate([s(cc.Prefab)],t.prototype,"ShareLayer",void 0),t=__decorate([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./Audio":"Audio","./Helper":"Helper","./RoleHead":"RoleHead"}],Helper:[function(e,t,o){"use strict";cc._RF.push(t,"f3d2f0iDqNLCKidlXjde/DH","Helper"),Object.defineProperty(o,"__esModule",{value:!0}),function(e){e.gameExited="gameExited",e.allReady="allReady",e.adPlay="adPlay",e.roundOver="roundOver"}(o.HelperEvent||(o.HelperEvent={}));var i=function(){function e(){this.roleInfo=null,this.gameId=1,this.openid=1,this.rate=1,this.roundId=1,cc.log("helper"),this.rate=1,this.init()}return Object.defineProperty(e,"ins",{get:function(){return null==this._ins&&(this._ins=new e),this._ins},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;window.onload=function(){console.log("window load");var t=e.getUrlParam("platform");console.log("platform:"+t);var o=null;(o="ios"===t?window:document)&&(console.log("addEventListener"),o.addEventListener("message",function(t){console.log("receive data:"+t.data);var o=JSON.parse(t.data);"gameInit"==o.event?(e.roleInfo=o.profile,e.gameId=o.gameId,e.openid=o.profile.openid,e.rate=o.gameConf.exchangeRate,cc.log(JSON.stringify(e.roleInfo))):"roundStart"==o.event?e.roundId=o.roundId:"adCompleted"==o.event&&(console.log("adCompleted"),cc.game.emit("adCompleted",o))}))}},e.prototype.getUrlParam=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=window.location.search.substr(1).match(t);return null!=o?decodeURI(o[2]):null},e.prototype.sendRoundEvent=function(e,t){if(null!=this.roleInfo){var o={event:e,gameId:this.gameId,openid:this.openid,roundId:this.roundId,ext:t};if(window.ReactNativeWebView){var i=JSON.stringify(o);console.log("post data:"+i),window.ReactNativeWebView.postMessage(i)}}},e.prototype.sendEvent=function(e){if(null!=this.roleInfo){var t={event:e,gameId:this.gameId,openid:this.openid};if(window.ReactNativeWebView){var o=JSON.stringify(t);console.log("post data:"+o),window.ReactNativeWebView.postMessage(o)}}},e}();o.Helper=i,i.ins,cc._RF.pop()},{}],RoleHead:[function(e,t,o){"use strict";cc._RF.push(t,"bf452VVv7FE3YqIUV8PpTI6","RoleHead"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./Helper"),r=cc._decorator,n=r.ccclass,a=r.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.role1Icon=null,t.lbSocre=null,t.lbGold=null,t}return __extends(t,e),t.prototype.onCloseClick=function(){i.Helper.ins.sendEvent(i.HelperEvent.gameExited)},t.prototype.init=function(e){this._game=e,this._curCoin=0,this._initCoin=0,this.lbGold.string=this._curCoin+"";var t=i.Helper.ins.roleInfo;if(t){cc.log("role info"+JSON.stringify(t)),t.coinBalance&&(this.lbGold.string=t.coinBalance,this._initCoin=t.coinBalance);var o=t.headImgUrl+"?aaa=aa.jpg";cc.log("imgUrl:"+o);var r=this;cc.loader.load(o,function(e,t){e||(r.role1Icon.spriteFrame=new cc.SpriteFrame(t))})}},t.prototype.setCoin=function(e){this._curCoin=e,this.lbGold.string=this._curCoin+this._initCoin+""},t.prototype.doubleCoin=function(){this._curCoin*=10,this.lbGold.string=this._curCoin+""},__decorate([a(cc.Sprite)],t.prototype,"role1Icon",void 0),__decorate([a(cc.Label)],t.prototype,"lbSocre",void 0),__decorate([a(cc.Label)],t.prototype,"lbGold",void 0),t=__decorate([n],t)}(cc.Component);o.default=c,cc._RF.pop()},{"./Helper":"Helper"}],Share:[function(e,t,o){"use strict";cc._RF.push(t,"693de2egi9MCbZjfvuMh/vI","Share"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,n=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},t.prototype.onTouchEnd=function(){this.node.destroy()},t=__decorate([r],t)}(cc.Component));o.default=n,cc._RF.pop()},{}],Timer:[function(e,t,o){"use strict";cc._RF.push(t,"bfc12RY7PJKv4QbwHNDaxRM","Timer"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,n=i.property,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lbTimer=null,t}return __extends(t,e),t.prototype.init=function(e){this._game=e,this.time=3,this.lbTimer.string=this.time+""},t.prototype.update=function(e){this.time-=e,this.lbTimer.string=Math.ceil(this.time)+"",this.time<=0&&(this.node.destroy(),this._game.continueGame())},__decorate([n(cc.Label)],t.prototype,"lbTimer",void 0),t=__decorate([r],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(e,t,o){"use strict";cc._RF.push(t,"50c59yTrcRBKY78GP2Twphh","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}]},{},["Audio","ExitGame","Game","GameOver","Helper","RoleHead","Share","Timer","use_v2.0.x_cc.Toggle_event"]);